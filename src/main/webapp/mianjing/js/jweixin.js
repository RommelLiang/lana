!function(t,e){"function"==typeof define&&(define.amd||define.cmd)?define(function(){return e(t)}):e(t,!0)}(this,function(t,e){function i(e,i,n){t.WeixinJSBridge?WeixinJSBridge.invoke(e,s(i),function(t){a(e,t,n)}):h(e,n)}function n(e,i,n){t.WeixinJSBridge?WeixinJSBridge.on(e,function(t){n&&n.trigger&&n.trigger(t),a(e,t,i)}):n?h(e,n):h(e,i)}function s(t){return t=t||{},t.appId=T.appId,t.verifyAppId=T.appId,t.verifySignType="sha1",t.verifyTimestamp=T.timestamp+"",t.verifyNonceStr=T.nonceStr,t.verifySignature=T.signature,t}function o(t){return{timeStamp:t.timestamp+"",nonceStr:t.nonceStr,"package":t["package"],paySign:t.paySign,signType:t.signType||"SHA1"}}function a(t,e,i){var n,s,o;switch(delete e.err_code,delete e.err_desc,delete e.err_detail,n=e.errMsg,n||(n=e.err_msg,delete e.err_msg,n=r(t,n),e.errMsg=n),i=i||{},i._complete&&(i._complete(e),delete i._complete),n=e.errMsg||"",T.debug&&!i.isInnerInvoke&&alert(JSON.stringify(e)),s=n.indexOf(":"),o=n.substring(s+1)){case"ok":i.success&&i.success(e);break;case"cancel":i.cancel&&i.cancel(e);break;default:i.fail&&i.fail(e)}i.complete&&i.complete(e)}function r(t,e){var i,n,s=t,o=m[s];return o&&(s=o),i="ok",e&&(n=e.indexOf(":"),i=e.substring(n+1),"confirm"==i&&(i="ok"),"failed"==i&&(i="fail"),-1!=i.indexOf("failed_")&&(i=i.substring(7)),-1!=i.indexOf("fail_")&&(i=i.substring(5)),i=i.replace(/_/g," "),i=i.toLowerCase(),("access denied"==i||"no permission to execute"==i)&&(i="permission denied"),"config"==s&&"function not exist"==i&&(i="ok"),""==i&&(i="fail")),e=s+":"+i}function l(t){var e,i,n,s;if(t){for(e=0,i=t.length;i>e;++e)n=t[e],s=f[n],s&&(t[e]=s);return t}}function h(t,e){if(!(!T.debug||e&&e.isInnerInvoke)){var i=m[t];i&&(t=i),e&&e._complete&&delete e._complete,console.log('"'+t+'",',e||"")}}function u(){if(!("6.0.2">x||C.systemType<0)){var t=new Image;C.appId=T.appId,C.initTime=k.initEndTime-k.initStartTime,C.preVerifyTime=k.preVerifyEndTime-k.preVerifyStartTime,I.getNetworkType({isInnerInvoke:!0,success:function(e){C.networkType=e.networkType;var i="https://open.weixin.qq.com/sdk/report?v="+C.version+"&o="+C.isPreVerifyOk+"&s="+C.systemType+"&c="+C.clientVersion+"&a="+C.appId+"&n="+C.networkType+"&i="+C.initTime+"&p="+C.preVerifyTime+"&u="+C.url;t.src=i}})}}function c(){return(new Date).getTime()}function d(e){y&&(t.WeixinJSBridge?e():g.addEventListener&&g.addEventListener("WeixinJSBridgeReady",e,!1))}function p(){I.invoke||(I.invoke=function(e,i,n){t.WeixinJSBridge&&WeixinJSBridge.invoke(e,s(i),n)},I.on=function(e,i){t.WeixinJSBridge&&WeixinJSBridge.on(e,i)})}var f,m,g,v,b,y,_,w,x,k,C,T,D,S,I;return t.jWeixin?void 0:(f={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest"},m=function(){var t,e={};for(t in f)e[f[t]]=t;return e}(),g=t.document,v=g.title,b=navigator.userAgent.toLowerCase(),y=-1!=b.indexOf("micromessenger"),_=-1!=b.indexOf("android"),w=-1!=b.indexOf("iphone")||-1!=b.indexOf("ipad"),x=function(){var t=b.match(/micromessenger\/(\d+\.\d+\.\d+)/)||b.match(/micromessenger\/(\d+\.\d+)/);return t?t[1]:""}(),k={initStartTime:c(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},C={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:w?1:_?2:-1,clientVersion:x,url:encodeURIComponent(location.href)},T={},D={_completes:[]},S={state:0,res:{}},d(function(){k.initEndTime=c()}),I={config:function(t){T=t,h("config",t);var e=T.check===!1?!1:!0;d(function(){var t,n,s;if(e)i(f.config,{verifyJsApiList:l(T.jsApiList)},function(){D._complete=function(t){k.preVerifyEndTime=c(),S.state=1,S.res=t},D.success=function(){C.isPreVerifyOk=0},D.fail=function(t){D._fail?D._fail(t):S.state=-1};var t=D._completes;return t.push(function(){T.debug||u()}),D.complete=function(){for(var e=0,i=t.length;i>e;++e)t[e]();D._completes=[]},D}()),k.preVerifyStartTime=c();else{for(S.state=1,t=D._completes,n=0,s=t.length;s>n;++n)t[n]();D._completes=[]}}),T.beta&&p()},ready:function(t){0!=S.state?t():(D._completes.push(t),!y&&T.debug&&t())},error:function(t){"6.0.2">x||(-1==S.state?t(S.res):D._fail=t)},checkJsApi:function(t){var e=function(t){var e,i,n=t.checkResult;for(e in n)i=m[e],i&&(n[i]=n[e],delete n[e]);return t};i("checkJsApi",{jsApiList:l(t.jsApiList)},function(){return t._complete=function(t){if(_){var i=t.checkResult;i&&(t.checkResult=JSON.parse(i))}t=e(t)},t}())},onMenuShareTimeline:function(t){n(f.onMenuShareTimeline,{complete:function(){i("shareTimeline",{title:t.title||v,desc:t.title||v,img_url:t.imgUrl||"",link:t.link||location.href,type:t.type||"link",data_url:t.dataUrl||""},t)}},t)},onMenuShareAppMessage:function(t){n(f.onMenuShareAppMessage,{complete:function(){i("sendAppMessage",{title:t.title||v,desc:t.desc||"",link:t.link||location.href,img_url:t.imgUrl||"",type:t.type||"link",data_url:t.dataUrl||""},t)}},t)},onMenuShareQQ:function(t){n(f.onMenuShareQQ,{complete:function(){i("shareQQ",{title:t.title||v,desc:t.desc||"",img_url:t.imgUrl||"",link:t.link||location.href},t)}},t)},onMenuShareWeibo:function(t){n(f.onMenuShareWeibo,{complete:function(){i("shareWeiboApp",{title:t.title||v,desc:t.desc||"",img_url:t.imgUrl||"",link:t.link||location.href},t)}},t)},onMenuShareQZone:function(t){n(f.onMenuShareQZone,{complete:function(){i("shareQZone",{title:t.title||v,desc:t.desc||"",img_url:t.imgUrl||"",link:t.link||location.href},t)}},t)},startRecord:function(t){i("startRecord",{},t)},stopRecord:function(t){i("stopRecord",{},t)},onVoiceRecordEnd:function(t){n("onVoiceRecordEnd",t)},playVoice:function(t){i("playVoice",{localId:t.localId},t)},pauseVoice:function(t){i("pauseVoice",{localId:t.localId},t)},stopVoice:function(t){i("stopVoice",{localId:t.localId},t)},onVoicePlayEnd:function(t){n("onVoicePlayEnd",t)},uploadVoice:function(t){i("uploadVoice",{localId:t.localId,isShowProgressTips:0==t.isShowProgressTips?0:1},t)},downloadVoice:function(t){i("downloadVoice",{serverId:t.serverId,isShowProgressTips:0==t.isShowProgressTips?0:1},t)},translateVoice:function(t){i("translateVoice",{localId:t.localId,isShowProgressTips:0==t.isShowProgressTips?0:1},t)},chooseImage:function(t){i("chooseImage",{scene:"1|2",count:t.count||9,sizeType:t.sizeType||["original","compressed"],sourceType:t.sourceType||["album","camera"]},function(){return t._complete=function(t){if(_){var e=t.localIds;e&&(t.localIds=JSON.parse(e))}},t}())},previewImage:function(t){i(f.previewImage,{current:t.current,urls:t.urls},t)},uploadImage:function(t){i("uploadImage",{localId:t.localId,isShowProgressTips:0==t.isShowProgressTips?0:1},t)},downloadImage:function(t){i("downloadImage",{serverId:t.serverId,isShowProgressTips:0==t.isShowProgressTips?0:1},t)},getNetworkType:function(t){var e=function(t){var e,i,n,s=t.errMsg;if(t.errMsg="getNetworkType:ok",e=t.subtype,delete t.subtype,e)t.networkType=e;else switch(i=s.indexOf(":"),n=s.substring(i+1)){case"wifi":case"edge":case"wwan":t.networkType=n;break;default:t.errMsg="getNetworkType:fail"}return t};i("getNetworkType",{},function(){return t._complete=function(t){t=e(t)},t}())},openLocation:function(t){i("openLocation",{latitude:t.latitude,longitude:t.longitude,name:t.name||"",address:t.address||"",scale:t.scale||28,infoUrl:t.infoUrl||""},t)},getLocation:function(t){t=t||{},i(f.getLocation,{type:t.type||"wgs84"},function(){return t._complete=function(t){delete t.type},t}())},hideOptionMenu:function(t){i("hideOptionMenu",{},t)},showOptionMenu:function(t){i("showOptionMenu",{},t)},closeWindow:function(t){t=t||{},i("closeWindow",{immediate_close:t.immediateClose||0},t)},hideMenuItems:function(t){i("hideMenuItems",{menuList:t.menuList},t)},showMenuItems:function(t){i("showMenuItems",{menuList:t.menuList},t)},hideAllNonBaseMenuItem:function(t){i("hideAllNonBaseMenuItem",{},t)},showAllNonBaseMenuItem:function(t){i("showAllNonBaseMenuItem",{},t)},scanQRCode:function(t){t=t||{},i("scanQRCode",{needResult:t.needResult||0,scanType:t.scanType||["qrCode","barCode"]},function(){return t._complete=function(t){var e,i;w&&(e=t.resultStr,e&&(i=JSON.parse(e),t.resultStr=i&&i.scan_code&&i.scan_code.scan_result))},t}())},openProductSpecificView:function(t){i(f.openProductSpecificView,{pid:t.productId,view_type:t.viewType||0,ext_info:t.extInfo},t)},addCard:function(t){var e,n,s,o,a=t.cardList,r=[];for(e=0,n=a.length;n>e;++e)s=a[e],o={card_id:s.cardId,card_ext:s.cardExt},r.push(o);i(f.addCard,{card_list:r},function(){return t._complete=function(t){var e,i,n,s=t.card_list;if(s){for(s=JSON.parse(s),e=0,i=s.length;i>e;++e)n=s[e],n.cardId=n.card_id,n.cardExt=n.card_ext,n.isSuccess=n.is_succ?!0:!1,delete n.card_id,delete n.card_ext,delete n.is_succ;t.cardList=s,delete t.card_list}},t}())},chooseCard:function(t){i("chooseCard",{app_id:T.appId,location_id:t.shopId||"",sign_type:t.signType||"SHA1",card_id:t.cardId||"",card_type:t.cardType||"",card_sign:t.cardSign,time_stamp:t.timestamp+"",nonce_str:t.nonceStr},function(){return t._complete=function(t){t.cardList=t.choose_card_info,delete t.choose_card_info},t}())},openCard:function(t){var e,n,s,o,a=t.cardList,r=[];for(e=0,n=a.length;n>e;++e)s=a[e],o={card_id:s.cardId,code:s.code},r.push(o);i(f.openCard,{card_list:r},t)},chooseWXPay:function(t){i(f.chooseWXPay,o(t),t)}},e&&(t.wx=t.jWeixin=I),I)});